Add-PSSnapin VeeamPSSnapin
$ScriptPath = Split-Path -Parent -Path $MyInvocation.MyCommand.Definition
$date1 = Get-Date -Date "01/01/1970"
$date2 = Get-Date

$Epoch = (New-TimeSpan -Start $date1 -End $date2).TotalSeconds
Get-VBRViProxy -Name * | Select @{N="#Date";E={$date2}}, @{N="Name";E={$_.Name}}, @{N="Host";E={$_.Host}}, @{N="Type";E={$_.Type}}, @{N="IsDisabled";E={$_.IsDisabled}},@{N="Description";E={$_.Description}}  | Export-csv -Path $ScriptPath\working\"BKPPXY"$Epoch.csv -NoTypeInformation 
Get-VBRBackupRepository | Select @{N="#Date";E={((Get-Date))}},@{N="Name";E={$_.Name}},@{N="Path";E={$_.Path}}, @{N="FreeSpace";E={[math]::Round(($_.Info.CachedFreeSpace | Measure-Object -Sum).Sum/1GB,1)}},@{N="TotalSpace";E={[math]::Round(($_.Info.CachedTotalSpace | Measure-Object -Sum).Sum/1GB,1)}}, @{N="Id";E={$_.Id}} |Export-csv -Path $ScriptPath\working\"VBREPO"$Epoch.csv -NoTypeInformation 
Get-VBRServer -Name * | Select @{N="#Date";E={$date2}}, @{N="Name";E={$_.Name}}, @{N="Info";E={$_.Info}}, @{N="Type";E={$_.Type}}, @{N="ApiVersion";E={$_.Apiversion}} | Export-csv -Path $ScriptPath\working\"BKPSVR"$Epoch.csv -NoTypeInformation 
Get-VBRJob -Name * | Select @{N="#Date";E={$_.FindLastSession().Progress.StartTime}}, @{N="Session";E={$_.FindLastSession().Name}},@{N="TransferedGB";E={[math]::Round(($_.FindLastSession().Info.Progress.TransferedSize | Measure-Object -Sum).Sum/1GB,1)}},@{N="Duration";E={$_.FindLastSession().Progress.Duration}},@{N="id";E={$_.FindLastSession().Id}},@{N="TotalSize";E={[math]::Round(($_.FindLastSession().Progress.TotalSize | Measure-Object -Sum).Sum/1GB,1)}},@{N="TotalUsedSize";E={[math]::Round(($_.FindLastSession().Progress.TotalUsedSize | Measure-Object -Sum).Sum/1GB,1)}},@{N="AvgSpeed";E={[math]::Round(($_.FindLastSession().Progress.AvgSpeed | Measure-Object -Sum).Sum/1MB,1)}},@{N="Result";E={$_.FindLastSession().Result}},@{N="GetType";E={$_.Info.JobType}},@{N="EndTime";E={$_.FindLastSession().Progress.StopTime}} | Export-csv -Path $ScriptPath\working\"JOBDET"$Epoch.csv -NoTypeInformation 
Get-VBRBackup -Name * | Select @{N="#Date";E={$_.LastPointCreationTime}}, @{N="Job_Name";E={$_.Name}}, @{N="Size";E={[math]::Round(($_.GetAllStorages().Stats.BackupSize | Measure-Object -Sum).Sum/1GB,1)}},@{N="DataSize";E={[math]::Round(($_.GetAllStorages().Stats.DataSize | Measure-Object -Sum).Sum/1GB,1)}}, @{N="JobID";E={$_.JobId}},@{N="VmCount";E={$_.VmCount}}|Export-csv -Path $ScriptPath\working\"JOBTOT"$Epoch.csv -NoTypeInformation 
Get-VBRBackupSession -Name * | Get-VBRTaskSession | Select @{N="#Date";E={$_.Info.QueuedTime}}, @{N="Id";E={$_.Id}},@{N="Name";E={$_.Name}}, @{N="JobName";E={$_.JobName}}, @{N="JobSessId";E={$_.JobSessId}}, @{N="Status";E={$_.Status}}, @{N="Reason";E={$_.Info.Reason}} | Export-csv -Path $ScriptPath\working\"JOBTSK"$Epoch.csv -NoTypeInformation 
disconnect-vbrserver